<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Aanmaken</title>
    
    <script>
      function checkMember() {
        fetch("https://yc2301hotelbackend.azurewebsites.net/checkMember/a")
        .then(r => r.json())
        .then(d => checkDubbeleemail(d))
      }

      function checkDubbeleemail(data) {
        var duplicate = false;
        for (var x=0; x < data.length; x++) {
          if (data[x][0] == document.getElementById("kemaili").value) {
          duplicate = true;
          console.log(data[x][0]+" is een duplicate.");
          break
          }
        }

        if (duplicate == true) {
          alert("Dit e-mailadres is al in gebruik."+data[x][0]);
        }

        else {
          slaMemberop();
        }

        }

        console.log("Uw gegevens zijn opgeslagen!");

      
      window.onload = function() {
        document.getElementById("memberWorden").addEventListener('submit', function(ev){
        ev.preventDefault()
    })
      }
      function slaMemberop(){
        var mijnPost = {}
          mijnPost.voornaam = document.getElementById("kvoornaami").value
          mijnPost.kachternaam = document.getElementById("kachternaami").value
          mijnPost.voorvoegsel = document.getElementById("kvoorvoegseli").value
          mijnPost.adres = document.getElementById("kadresi").value
          mijnPost.postcode = document.getElementById("kpcodei").value
          mijnPost.land = document.getElementById("klandi").value
          mijnPost.tel = document.getElementById("kteli").value
          mijnPost.email = document.getElementById("kemaili").value
          mijnPost.wachtwoord = document.getElementById("kwachtwoordi").value
          
          var mijnPostjson = JSON.stringify(mijnPost)
          fetch('https://yc2301hotelbackend.azurewebsites.net/saveMember', {
          method: 'POST',
          headers: {
          'Content-Type': 'application/json',
          },
          body: mijnPostjson
          })

  .then(res => {
    console.log(res)
  })
      }
    </script>

    <link href="daanreserveringspagina.css" rel="stylesheet" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>

</head>

<body>
  
  <form id="memberWorden">
    <br>
    <div class="form-group">
      <label for="kemail"><b>E-mailadres</b></label>
      <input type="email" name="kemail" class="form-control" id="kemaili" aria-describedby="emailHelp" placeholder="E-mailadres" required>
    </div>

    <div class="form-group">
      <label for="kland"><b>Wachtwoord</b></label>
      <input type="text" name=kland class="form-control" id="kwachtwoordi" placeholder="Wachtwoord" required>
    </div>   
    
    <br>
    
    <div class="form-group">
      <label for="kvoornaam"><b>Voornaam</b></label>
      <input type="text" name="kvoornaam" class="form-control" id="kvoornaami" aria-describedby="emailHelp" placeholder="Voornaam" required>
    </div>
    
    <div class="form-group">
      <label for="kachternaam"><b>Achternaam</b></label>
      <input type="text" name="kachternaam" class="form-control" id="kachternaami" aria-describedby="emailHelp" placeholder="Achternaam" required>
    </div>
    
    <div class="form-group">
      <label for="kvoorvoegsel"><b>Voorvoegsel</b></label>
      <input type="text" name="kvoorvoegsel" class="form-control" id="kvoorvoegseli" aria-describedby="emailHelp" placeholder="Voorvoegsel" maxlength="10">
    </div>    
    
    <div class="form-group">
      <label for="kadres"><b>Straatnaam en huisnummer</b></label>
      <input type="text" name="kadres" class="form-control" id="kadresi" aria-describedby="adresHelp" placeholder="Straatnaam + huisnummer" required>
    </div>
    
    <div class="form-group">
      <label for="kpcode"><b>Postcode</b></label>
      <input type="text" name=kpcode class="form-control" id="kpcodei" placeholder="Postcode" required>
    </div>
    
    <div class="form-group">
      <label for="kland"><b>Land woonplaats</b></label>
      <input type="text" name=kland class="form-control" id="klandi" placeholder="Land" required>
    </div>
    
    <div class="form-group">
      <label for="ktel"><b>Telefoonnummer</b></label>
      <input type="tel" name=ktel class="form-control" id="kteli" aria-describedby="emailHelp" placeholder="06-xxxxxxxxxx" required>

    </div>

    <button type="submit" id="knoprechts" onclick="checkMember()">
      Wordt Member!
    </button>
  </form>
</body>


</html>